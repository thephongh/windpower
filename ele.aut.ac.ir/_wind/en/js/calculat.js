// Copyright 1997, 1998 S¿ren Krohn & Dansih Wind Turbine Manufacturers AssociationRe(1);gPlot = 0;function Re(n){	if (Math.abs(this.document.forms[0].elements[n].value) > 30)	{		alert("Wind speeds above 30 m/s are very rare. Wind turbines are usually designed to stop automatically at such high wind speeds in order to protect the turbines and their surroundings, please try again");		this.document.forms[0].elements[n].value = "0";	}	var theHeightIndex=Math.floor(n/7);	var k = theHeightIndex * 7;	for (var i=k;i<k+7;i++) { this.document.forms[0].elements[i].value = this.document.forms[0].elements[n].value; }	var theClassIndex = 0;// Roughness lengths for class 0, 0.5, 1, 1.5, 2, 3, 4	var theRLength = new Array(0.0002,0.0024,0.03,0.055,0.1,0.4,1.6);	var theHeight = new Array(100,90,80,70,60,50,40,30,20,10);	var theRefSpeed = this.document.forms[0].elements[0].value;	// Recalculate using field n as input data	var theRefRoughness=theRLength[0];	theClassIndex=n%7;	theRefSpeed=this.document.forms[0].elements[n].value;	theRefRoughness=theRLength[theClassIndex];	for (var j=0; j<7; j++)	{		for (var i=0; i<10; i++)		{			var theRes = WSpeed(theHeight[i], theRLength[j], theHeight[theHeightIndex], theRefSpeed, theRLength[j]);			theRes = 0.01 * Math.round(100 * theRes);			if (theRes < 10) theRes = " "+theRes;			this.document.forms[0].elements[j+i*7].value = theRes;		}	}}function WSpeed(height, roughness, refHeight, refSpeed, refRoughness){	return(refSpeed*Math.log(height/roughness)/Math.log(refHeight/refRoughness));}function Zap(){	for (var i=0;i<70;i++) this.document.forms[0].elements[i].value = "";}function Plot(n) {	gPlot = window.open("","","status=yes,width=390,height=290");	gPlot.document.clear();	var theRLength = new Array(0.0002,0.0024,0.03,0.055,0.1,0.4,1.6);	var rl = theRLength[n%7];	var xv = Math.abs(document.forms[0].elements[n].value);	var refSpeed = xv;	var max = Math.ceil(xv);	gPlot.document.write("<HTML><HEAD><TITLE>Wind Speeds at Different Heights</TITLE></HEAD><BODY BGCOLOR='#ffffff'>");	gPlot.document.write("<TABLE WIDTH='320' BORDER='0' CELLSPACING='0' CELLPADDING='0'><TR>");	gPlot.document.write("</TR><TD COLSPAN='"+ (max+2) + "'><FONT SIZE=2 FACE='gillsans, frutiger, arial, helvetica, geneva'><IMG SRC='../../r/t.gif' HEIGHT='1' WIDTH='11'>Roughness length = " + rl + "<BR>m height<BR><IMG SRC='../../r/t.gif' HEIGHT='3' WIDTH='3'></FONT><TR>");	gPlot.document.write("<TD WIDTH='19' VALIGN='TOP'><P ALIGN=RIGHT><FONT SIZE='1'>100 </FONT></TD><TD ROWSPAN='10' WIDTH='1' VALIGN='TOP'><IMG SRC='../../res/blpix.gif' HEIGHT='201' WIDTH='1' ALIGN='RIGHT' HSPACE='0'></TD>");	gPlot.document.write("<TD ROWSPAN='10' COLSPAN='" + max + "' WIDTH='300' VALIGN='TOP'>");	var f = Math.round(300/max);	var oldx = Math.round(f*xv);	var w = 1;	var pix = "";	for (var i=0;i<200;i++) {		xv = Math.round(f*WSpeed(0.5*(200-i), rl, 100, refSpeed, rl));		pix = '../../r/t.gif';		if (i%20==0) pix = '../../res/blpix.gif';		gPlot.document.write("<IMG SRC='"+ pix +"' HEIGHT='1' WIDTH='"+(xv-1)+"'>");		w = oldx-xv;		if (w<1) w=1;		gPlot.document.write("<IMG SRC='../../res/bluepix.gif' HEIGHT='1' WIDTH='"+(1+oldx-xv)+"'>");		oldx = xv;		if (i%20==0) gPlot.document.write("<IMG SRC='"+ pix +"' HEIGHT='1' WIDTH='"+(300-xv-w)+"'>");		gPlot.document.write("<BR>");	}	gPlot.document.write("<IMG SRC='../../res/blpix.gif' HEIGHT='1' WIDTH='"+(300)+"' HSPACE='0' VSPACE='0'></TD></TR>");	for (var i=0;i<9;i++) {		gPlot.document.write("<TR><TD WIDTH='19'  VALIGN='TOP'><P ALIGN=RIGHT><FONT SIZE='1'>"+(10*(9-i))+" </FONT></TD></TR>");	}	gPlot.document.write("<TR><TD COLSPAN='2'></TD><TD VALIGN='TOP' COLSPAN='"+ max +"' >");	for (var i=0; i<max; i++) {		gPlot.document.write("<IMG SRC='../../r/t.gif' HEIGHT='1' WIDTH='"+(f-1)+"'>");		gPlot.document.write("<IMG SRC='../../res/blpix.gif' HEIGHT='3' WIDTH='1'>");	}	gPlot.document.write("</TD></TR>");	gPlot.document.write("<TR><TD COLSPAN='2'></TD>");	for (var i=0;i<max;i++) {		gPlot.document.write("<TD VALIGN='TOP'><FONT SIZE=1>" + i + "</FONT><BR><IMG SRC='../../r/t.gif' HEIGHT='1' WIDTH='"+(f)+"'></TD>");	}	gPlot.document.write("</TR><TR><TD COLSPAN='"+ (max+2) + "' VALIGN='TOP'><P ALIGN=RIGHT><FONT SIZE=2 FACE='gillsans, frutiger, arial, helvetica, geneva'>m/s<BR><FONT COLOR='0066CC' SIZE=2>&copy; 1998 Danish Wind Turbine Manufacturers Association</FONT></FONT></TD>");	gPlot.document.write("</TR></TABLE></BODY></HTML>");	gPlot.document.close();	gPlot.focus();}